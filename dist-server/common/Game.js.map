{"version":3,"sources":["../../src/common/Game.js"],"names":["Plate","gameEngine","options","props","bites","blocked","canAttack","count","isWinner","nameee","playerId","playing","other","Object","assign","type","BaseTypes","TYPES","INT8","STRING","DynamicObject","Game","physicsEngine","SimplePhysicsEngine","on","gameLogic","bind","serverSideInit","serverSidePlayerJoined","serverSidePlayerDisconnected","clientSideInit","clientSideDraw","data","plate","world","queryObject","console","log","name","length","serializer","registerClass","plates","queryObjects","instanceType","forEach","p","i","PLATE_BITES","COUNTS_TO_WIN","inputData","input","plateOnTheLeft","setInterval","BLOCKED_TIME_FROM_KICK","plateOnTheRight","otherPlates","filter","map","BLOCKED_TIME_FROM_ATTACK","initValues","PLAYERS_COUNT","addObjectToWorld","ev","joined","removeObjectFromWorld","id","DEBUG","window","addEventListener","returnValue","document","querySelector","table","classList","add","toggle","remove","style","width","PLAYER_WIDTH_BUFFER","BITE_WIDTH","playerInfo","push","innerHTML","concat","join","substring","GameEngine"],"mappings":"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","sourcesContent":["import {\n  BaseTypes,\n  DynamicObject,\n  GameEngine,\n  SimplePhysicsEngine\n} from 'lance-gg'\n\nimport {\n  initBites,\n  initNameForm,\n  initPlayers,\n  initStart,\n  initTables\n} from './lib/init-helpers.js'\n\nimport {\n  BITE_WIDTH,\n  BLOCKED_TIME_FROM_ATTACK,\n  BLOCKED_TIME_FROM_KICK,\n  COUNTS_TO_WIN,\n  DEBUG,\n  PLATE_BITES,\n  PLAYER_WIDTH_BUFFER,\n  PLAYERS_COUNT\n} from './lib/constants.js'\n\n// A paddle has a health attribute\nclass Plate extends DynamicObject {\n  constructor (gameEngine, options, props) {\n    super(gameEngine, options, props)\n\n    this.bites = 0\n    this.blocked = 0\n    this.canAttack = 0\n    this.count = 0\n    this.isWinner = 0\n    this.nameee = ''\n    this.playerId = 0\n    this.playing = 0\n  }\n\n  static get netScheme () {\n    return Object.assign({\n      bites: { type: BaseTypes.TYPES.INT8 },\n      blocked: { type: BaseTypes.TYPES.INT8 },\n      canAttack: { type: BaseTypes.TYPES.INT8 },\n      count: { type: BaseTypes.TYPES.INT8 },\n      isWinner: { type: BaseTypes.TYPES.INT8 },\n      nameee: { type: BaseTypes.TYPES.STRING },\n      playerId: { type: BaseTypes.TYPES.INT8 },\n      playing: { type: BaseTypes.TYPES.INT8 }\n    }, super.netScheme)\n  }\n\n  syncTo (other) {\n    super.syncTo(other)\n\n    this.bites = other.bites\n    this.blocked = other.blocked\n    this.canAttack = other.count\n    this.count = other.count\n    this.isWinner = other.isWinner\n    this.nameee = other.nameee\n    this.playerId = other.playerId\n    this.playing = other.playing\n  }\n}\n\nexport default class Game extends GameEngine {\n  constructor (options) {\n    super(options)\n    this.physicsEngine = new SimplePhysicsEngine({ gameEngine: this })\n\n    // common code\n    this.on('postStep', this.gameLogic.bind(this))\n\n    // server-only code\n    this.on('server__init', this.serverSideInit.bind(this))\n    this.on('server__playerJoined', this.serverSidePlayerJoined.bind(this))\n    this.on('server__playerDisconnected', this.serverSidePlayerDisconnected.bind(this))\n\n    // client-only code\n    this.on('client__rendererReady', this.clientSideInit.bind(this))\n    this.on('client__draw', this.clientSideDraw.bind(this))\n\n    this.on('nameee', this.nameee.bind(this))\n  }\n\n  nameee (data) {\n    const plate = this.world.queryObject({ playerId: data.playerId })\n\nconsole.log('data');\nconsole.log(data);\n\n    if (plate && data.name && data.name.length) {\n      plate.nameee = data.name\n    }\n  }\n\n  registerClasses (serializer) {\n    serializer.registerClass(Plate)\n  }\n\n  gameLogic () {\n    const plates = this.world.queryObjects({ instanceType: Plate })\n\n    if (plates.length < 2) {\n      return\n    }\n\n    plates.forEach((p, i) => {\n      if (p.bites === PLATE_BITES) {\n        p.count++\n        p.canAttack = 1\n        p.bites = 0\n\n        if (p.count === COUNTS_TO_WIN) {\n          p.blocked = 1\n          p.playing = 0\n          p.isWinner = 1\n        }\n      }\n    })\n  }\n\n  processInput (inputData, playerId) {\n    super.processInput(inputData, playerId)\n\n    if (inputData.input === 'start') {\n      const plates = this.world.queryObjects({ instanceType: Plate })\n\n      plates.forEach(p => {\n        p.blocked = 0\n        p.playing = 1\n      })\n    }\n\n    const plate = this.world.queryObject({ playerId })\n\n    if (!plate || !plate.playing) {\n      return\n    }\n\n    if (plate.blocked === 1) {\n      return\n    }\n\n    if (inputData.input === 'bite') {\n      plate.bites++\n    }\n\n    if (inputData.input === 'kickLeft') {\n      const plateOnTheLeft = this.world.queryObject({ playerId: playerId - 1 })\n\n      if (plateOnTheLeft) {\n        plateOnTheLeft.blocked = 1\n\n        setInterval(() => { plateOnTheLeft.blocked = 0 }, BLOCKED_TIME_FROM_KICK)\n      }\n    }\n\n    if (inputData.input === 'kickRight') {\n      const plateOnTheRight = this.world.queryObject({ playerId: playerId + 1 })\n\n      if (plateOnTheRight) {\n        plateOnTheRight.blocked = 1\n\n        setInterval(() => { plateOnTheRight.blocked = 0 }, BLOCKED_TIME_FROM_KICK)\n      }\n    }\n\n    if (inputData.input === 'attack' && plate.canAttack) {\n      plate.canAttack = 0\n\n      const plates = this.world.queryObjects({ instanceType: Plate })\n\n      const otherPlates = plates.filter(p => p.playerId !== playerId)\n\n      otherPlates.map(p => { p.blocked = 1 })\n\n      setInterval(() => otherPlates.map(p => { p.blocked = 0 }), BLOCKED_TIME_FROM_ATTACK)\n    }\n  }\n\n  //\n  // SERVER ONLY CODE\n  //\n  serverSideInit () {\n    const initValues = {\n      bites: 0,\n      blocked: 1,\n      count: 0,\n      isWinner: 0,\n      nameee: '',\n      playerId: 0,\n      playing: 0\n    }\n\n    for (let i = 0; i < PLAYERS_COUNT; i++) {\n      this.addObjectToWorld(new Plate(this, null, initValues))\n    }\n  }\n\n  // attach newly connected player to next available paddle\n  serverSidePlayerJoined (ev) {\n    const plates = this.world.queryObjects({ instanceType: Plate })\n\n    let joined = false\n\n    plates.filter(p => p.playerId === 0).forEach(plate => {\n      if (joined) {\n        return\n      }\n\n      if (plate.playerId === 0) {\n        plate.playerId = ev.playerId\n\n        joined = true\n      }\n    })\n  }\n\n  serverSidePlayerDisconnected (ev) {\n    const plates = this.world.queryObjects({ instanceType: Plate })\n\n    plates.forEach(plate => {\n      if (plate.playerId !== ev.playerId) {\n        return\n      }\n      this.removeObjectFromWorld(plate.id)\n    })\n  }\n\n  //\n  // CLIENT ONLY CODE\n  //\n  clientSideInit () {\n    initBites(this)\n    initNameForm(this)\n    initPlayers()\n    initStart(this)\n    initTables()\n\n    if (!DEBUG) {\n      window.addEventListener('beforeunload', ev => {\n        ev.returnValue = 'Are you sure you want to leave the game?'\n      })\n    }\n  }\n\n  clientSideDraw () {\n    const plates = this.world.queryObjects({ instanceType: Plate })\n\n    // const winner = plates.reduce((w, p) => p.isWinner === 1 ? p.playerId : '')\n\n    plates.forEach((p, i) => {\n      const plate = document.querySelector('#player' + i)\n      const table = document.querySelector('#table' + i)\n\n      if (!plate) {\n        return\n      }\n\n      if (!p.playerId) {\n        plate.classList.add('hidden')\n        return\n      }\n\n      if (p.isWinner) {\n        plate.classList.add('winner')\n      }\n\n      plate.classList.toggle('blocked', p.blocked)\n      plate.classList.toggle('canAttack', p.canAttack)\n      plate.classList.toggle('playing', p.playing)\n\n      if (this.playerId === p.playerId) {\n        document.querySelector('#attack').classList.toggle('canAttack', p.canAttack)\n      }\n\n      plate.classList.remove('hidden')\n\n      plate.style.width = PLAYER_WIDTH_BUFFER + ((PLATE_BITES - p.bites) * BITE_WIDTH) + 'px'\n\n      const playerInfo = []\n\n      if (DEBUG) {\n        playerInfo.push(p.playerId)\n      }\n\n      plate.innerHTML = playerInfo\n        .concat(p.nameee, p.count, p.bites)\n        .join(' ')\n\n      table.classList.remove('hidden')\n\n      table.innerHTML = p.nameee.substring(0, 1)\n    })\n  }\n}\n"],"file":"Game.js"}