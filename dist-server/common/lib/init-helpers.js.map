{"version":3,"sources":["../../../src/common/lib/init-helpers.js"],"names":["initBites","game","controls","KeyboardControls","renderer","clientEngine","order","DEBUG","bites","document","querySelector","forEach","o","button","createElement","classList","add","setAttribute","innerHTML","addEventListener","ev","querySelectorAll","length","contains","sendInput","PLATE_BITES","i","children","appendChild","Math","random","b","remove","initPlayers","players","PLAYERS_COUNT","player"],"mappings":"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","sourcesContent":["import { KeyboardControls } from 'lance-gg'\n\nimport { shuffle } from './misc.js'\n\nimport { DEBUG, PLATE_BITES, PLAYERS_COUNT } from './constants.js'\n\nconst initBites = game => {\n  game.controls = new KeyboardControls(game.renderer.clientEngine)\n\n  const order = [0, 1, 2, 3, 4, 5, 6, 7, 8]\n\n  if (!DEBUG) {\n    shuffle(order)\n  }\n\n  const bites = document.querySelector('#bites')\n\n  order.forEach(o => {\n    const button = document.createElement('button')\n\n    button.classList.add('bite', 'button')\n\n    button.setAttribute('data-order', o)\n\n    if (DEBUG) {\n      button.innerHTML = 'bite ' + o\n    }\n\n    button.addEventListener('click', ev => {\n      if (o !== document.querySelectorAll('.bite.hidden').length) {\n        return true\n      }\n\n      if (button.classList.contains('blocked')) {\n        return true\n      }\n\n      button.classList.add('hidden')\n\n      game.controls.clientEngine.sendInput('bite')\n\n      if (o === PLATE_BITES - 1) {\n        if (!DEBUG) {\n          const bites = document.querySelector('#bites')\n\n          for (let i = bites.children.length; i >= 0; i--) {\n            bites.appendChild(bites.children[Math.random() * i | 0])\n          }\n        }\n\n        document.querySelectorAll('.bite').forEach(b => b.classList.remove('hidden'))\n      }\n    })\n\n    bites.appendChild(button)\n  })\n}\n\nconst initPlayers = game => {\n  const players = document.querySelector('#players')\n\n  for (let i = 0; i < PLAYERS_COUNT; i++) {\n    const player = document.createElement('div')\n\n    player.classList.add('player', 'hidden')\n\n    player.setAttribute('id', 'player' + i)\n\n    players.appendChild(player)\n  }\n}\n\nexport { initBites, initPlayers }\n"],"file":"init-helpers.js"}