{"version":3,"sources":["../../../src/common/lib/init-helpers.js"],"names":["initBites","game","controls","KeyboardControls","renderer","clientEngine","order","DEBUG","bites","document","querySelector","forEach","o","button","createElement","classList","add","setAttribute","innerHTML","addEventListener","ev","querySelectorAll","length","plate","world","queryObject","playerId","blocked","playing","sendInput","PLATE_BITES","i","children","appendChild","Math","random","b","remove","initPlayers","players","PLAYERS_COUNT","player"],"mappings":"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","sourcesContent":["import { KeyboardControls } from 'lance-gg'\n\nimport { shuffle } from './misc.js'\n\nimport { DEBUG, PLATE_BITES, PLAYERS_COUNT } from './constants.js'\n\nconst initBites = game => {\n  game.controls = new KeyboardControls(game.renderer.clientEngine)\n\n  const order = [0, 1, 2, 3, 4, 5, 6, 7, 8]\n\n  if (!DEBUG) {\n    shuffle(order)\n  }\n\n  const bites = document.querySelector('#bites')\n\n  order.forEach(o => {\n    const button = document.createElement('button')\n\n    button.classList.add('bite', 'button')\n\n    button.setAttribute('data-order', o)\n\n    if (DEBUG) {\n      button.innerHTML = 'bite ' + o\n    }\n\n    button.addEventListener('click', ev => {\n      if (o !== document.querySelectorAll('.bite.hidden').length) {\n        return true\n      }\n\n      const plate = this.world.queryObject({ playerId: this.playerId })\n\n      if (!plate) {\n        return true\n      }\n\n      if (plate.blocked) {\n        return true\n      }\n\n      if (!plate.playing) {\n        return true\n      }\n\n      button.classList.add('hidden')\n\n      game.controls.clientEngine.sendInput('bite')\n\n      if (o === PLATE_BITES - 1) {\n        if (!DEBUG) {\n          const bites = document.querySelector('#bites')\n\n          for (let i = bites.children.length; i >= 0; i--) {\n            bites.appendChild(bites.children[Math.random() * i | 0])\n          }\n        }\n\n        document.querySelectorAll('.bite').forEach(b => b.classList.remove('hidden'))\n      }\n    })\n\n    bites.appendChild(button)\n  })\n}\n\nconst initPlayers = game => {\n  const players = document.querySelector('#players')\n\n  for (let i = 0; i < PLAYERS_COUNT; i++) {\n    const player = document.createElement('div')\n\n    player.classList.add('player', 'hidden')\n\n    player.setAttribute('id', 'player' + i)\n\n    players.appendChild(player)\n  }\n}\n\nexport { initBites, initPlayers }\n"],"file":"init-helpers.js"}